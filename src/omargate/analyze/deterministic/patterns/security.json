{
  "schema_version": "1.0",
  "patterns": [
    {
      "id": "SEC-001",
      "name": "Hardcoded API Key",
      "severity": "P1",
      "category": "secrets",
      "description": "API key hardcoded in source code",
      "regex": "(api[_-]?key|apikey)\\s*[=:]\\s*['\"][a-zA-Z0-9_-]{20,}['\"]",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "Potential hardcoded API key detected",
      "recommendation": "Move to environment variables or a secrets manager",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "placeholder", "xxx", "your-api-key"]
    },
    {
      "id": "SEC-002",
      "name": "Hardcoded Password",
      "severity": "P0",
      "category": "secrets",
      "description": "Password hardcoded in source code",
      "regex": "(password|passwd|pwd)\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "Potential hardcoded password detected",
      "recommendation": "Move passwords to environment variables or a secrets manager",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "placeholder", "changeme"]
    },
    {
      "id": "SEC-003",
      "name": "Hardcoded Secret",
      "severity": "P1",
      "category": "secrets",
      "description": "Secret or private key hardcoded in source code",
      "regex": "(secret|private[_-]?key)\\s*[=:]\\s*['\"][a-zA-Z0-9_-]{16,}['\"]",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "Potential hardcoded secret detected",
      "recommendation": "Store secrets in environment variables or a secrets manager",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "placeholder", "dummy"]
    },
    {
      "id": "SEC-004",
      "name": "AWS Access Key",
      "severity": "P0",
      "category": "secrets",
      "description": "AWS access key detected in code",
      "regex": "AKIA[0-9A-Z]{16}",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "AWS access key detected",
      "recommendation": "Revoke and rotate the key, use environment variables",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "sample", "not-a-key"]
    },
    {
      "id": "SEC-005",
      "name": "GitHub Token",
      "severity": "P0",
      "category": "secrets",
      "description": "GitHub access token detected in code",
      "regex": "gh[pousr]_[A-Za-z0-9_]{36,}",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "GitHub token detected",
      "recommendation": "Revoke and rotate the token, use GitHub Secrets",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "sample", "fake"]
    },
    {
      "id": "SEC-006",
      "name": "JWT Token",
      "severity": "P1",
      "category": "secrets",
      "description": "JWT token detected in code",
      "regex": "eyJ[A-Za-z0-9_-]*\\.eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.sh", "*.bash"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "JWT token detected",
      "recommendation": "Do not commit tokens; use environment variables",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "sample", "dummy"]
    },
    {
      "id": "SEC-007",
      "name": "CORS Allow All with Credentials",
      "severity": "P1",
      "category": "misconfig",
      "description": "CORS allows any origin with credentials enabled",
      "regex": "origin:\\s*(true|['\"]\\*['\"])\\s*.*credentials:\\s*true",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.json", "*.yml", "*.yaml"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "CORS allow-all with credentials detected",
      "recommendation": "Restrict allowed origins when credentials are enabled",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "sample", "localhost"]
    },
    {
      "id": "SEC-008",
      "name": "SQL Injection Risk",
      "severity": "P1",
      "category": "injection",
      "description": "Potential SQL injection via unsafe query execution",
      "regex": "(sql\\.unsafe|\\$queryRawUnsafe|execute\\s*\\(\\s*f['\"])",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "Potential SQL injection risk detected",
      "recommendation": "Use parameterized queries or safe query builders",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "docs", "safe"]
    },
    {
      "id": "SEC-009",
      "name": "dangerouslySetInnerHTML",
      "severity": "P1",
      "category": "xss",
      "description": "Use of dangerouslySetInnerHTML can lead to XSS",
      "regex": "dangerouslySetInnerHTML",
      "file_patterns": ["*.tsx", "*.jsx"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "dangerouslySetInnerHTML usage detected",
      "recommendation": "Sanitize HTML before rendering or avoid raw HTML",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "docs", "test"]
    },
    {
      "id": "SEC-010",
      "name": "eval() Usage",
      "severity": "P1",
      "category": "code-execution",
      "description": "Use of eval can lead to code injection",
      "regex": "\\beval\\s*\\(",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "eval() usage detected",
      "recommendation": "Avoid eval; use safe parsers or alternatives",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "docs", "test"]
    },
    {
      "id": "SEC-011",
      "name": "Disabled SSL Verify",
      "severity": "P1",
      "category": "crypto",
      "description": "SSL verification disabled in code",
      "regex": "(verify\\s*=\\s*False|rejectUnauthorized:\\s*false)",
      "file_patterns": ["*.py", "*.ts", "*.tsx", "*.js", "*.jsx"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "SSL verification disabled",
      "recommendation": "Enable SSL verification in production",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "test", "local"]
    },
    {
      "id": "SEC-012",
      "name": "Hardcoded IP/Host",
      "severity": "P2",
      "category": "network",
      "description": "Hardcoded IP address or host detected",
      "regex": "['\"]https?://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
      "file_patterns": ["*.ts", "*.tsx", "*.js", "*.jsx", "*.py", "*.java", "*.go", "*.rb", "*.php", "*.cs", "*.kt", "*.scala", "*.swift", "*.rs", "*.json", "*.yml", "*.yaml"],
      "exclude_patterns": ["*.test.*", "*.spec.*", "*_test.*", "test_*", "*.md", "*.rst", "*.txt"],
      "message": "Hardcoded IP/host detected",
      "recommendation": "Move hosts to configuration or environment variables",
      "evidence_capture": "line",
      "false_positive_hints": ["example", "localhost", "127.0.0.1"]
    }
  ]
}
